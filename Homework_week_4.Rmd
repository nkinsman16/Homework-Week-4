---
title: An R Markdown document converted from "Homework_week_4.ipynb"
output: html_document
---

<a href="https://colab.research.google.com/github/nkinsman16/Homework-Week-4/blob/main/Homework_week_4.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

```{r}
# list.files() returns the names of files and folders in my directory.
#Important to ensure I have uploaded the previous three documents from HW #3.
list.files()
```

```{r}
# The library(tidyverse) is a collection of R packages for data manipulation, visualization and analysis.
library(tidyverse)
```

```{r}
# We are reading all three documents using the read_csv() and store them as data frames and renaming them.
infant <- read_csv("infant_mortality_clean.csv") # Recallign the document infant
maternal <- read_csv("maternal_mortality_clean.csv") # Recalling the document maternal
life <- read_csv("Life_Expectancy_clean.csv") #realling the document life

# Verifying the column names to ensure the data is correctly show and prevent any errors.
colnames(infant)
colnames(maternal)
colnames(life)
```

```{r}
#Need to rename the data sets to ensure that the various variable columns are separated as we can't join them and we need them as individual columns.
infant <- infant %>% # Infant is the data frame being updated and reassigned the <- operator saves the modified version back to the same object. %>% pipe passes the data frame forward to the next function.
  rename(infant_mortality = variable) # Uses rename() to change the column variable to infant_mortality

maternal <- maternal %>% #Taking the maternal dataset and renaming the variable to maternal_mortality
  rename(maternal_mortality = variable) # Renaming variable in the maternal dataset to maternal_mortality

life <- life %>% # Taking the life dataset and renaming the variable column to life_expectancy
  rename(life_expectancy = variable) # Renaming the variable in the life dataset to life_expectancy
```

```{r}
# Creating a new dataset called merged_LMI, which stores the dataset infant as the main dataset, the %>% pipe passes it step by step through each join.
merged_LMI <- infant %>%
  left_join(maternal, by = c("country", "region")) %>% #Leftjoin() merges datasets while keeping all rows from infant, maternal and life datasets. Using Country and Region to match the rows across the datasets.
  left_join(life, by = c("country", "region"))   # Using Country and Region to merge the rows together.

# Need to confirm the joins were successful.
head(merged_LMI)
```

```{r}
# I wanted to reorder the columns so that country and region are together.
merged_LMI <- merged_LMI %>%
  select(country, region, infant_mortality, maternal_mortality, life_expectancy)
```

```{r}
# Confirming the column order
colnames(merged_LMI)
```

```{r}
#Creating a CSV for my merged content
write_csv(merged_LMI, "merged_LMI.csv")
```

```{r}
# Aggregate a aggregated file using region
merged_LMI_region_agg <- cia_merged %>%
  group_by(region) %>%   #Using the group by region to organizae the countries into regions.
  summarise( # Applying the summarise() to calculate the mean of the various columns, Infant_mortality, maternal_mortality, and life_expectancy
    mean_infant_mortality = mean(infant_mortality, na.rm = TRUE),  # Creates a new variable called mean_infant_mortality by using the mean() function to calculate the average, using na.rm = TRUE to removes missingh values, to ensure they don't distort the result.
    mean_maternal_mortality = mean(maternal_mortality, na.rm = TRUE), #Create a new variable called mean_maternal_mortality
    mean_life_expectancy = mean(life_expectancy, na.rm = TRUE) #Create a new variable called mean_life_expectancy
  )
```

```{r}
# Save aggregated dataset
write_csv(merged_LMI_region_agg, "merged_LMI_region_aggregated.csv")

# Verify file creation
file.exists("merged_LMI_region_aggregated.csv")
```

```{r}
#Converting our orginal merged dataset into the long version using the pivot_longer()
merged_LMI_long <- merged_LMI %>% # Creating the variable merged_LMI_long
  pivot_longer( # Pivot_longer() is a functin that reshapes data from wide format to long format by turning multiple columns into key-value pairs. Long format data easier to analyze, summarize and visualize
    cols = c(infant_mortality, maternal_mortality, life_expectancy), #Specifies the three health variables to be transformed
    names_to = "indicator", # names_to = "indictor" stores the the names as new categorical variables
    values_to = "value"   # values_to = "values" stores the corresponding
  )
```

```{r}
# Need to confirm the long format is successful.
head(merged_LMI_long)
```

```{r}
# Save long-format dataset
write_csv(merged_LMI_long, "merged_LMI_long.csv")

# Verify file creation
file.exists("merged_LMI_long.csv")
```

